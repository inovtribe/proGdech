CREATE TABLE bac (id_bac INT NOT NULL, id_collecte INT DEFAULT NULL, id_modelebac INT DEFAULT NULL, id_ptcollecte INT DEFAULT NULL, id_user INT DEFAULT NULL, ref_bac VARCHAR(20) NOT NULL, emplacement_bac INT DEFAULT NULL, date_bac DATE DEFAULT NULL, PRIMARY KEY(id_bac));
CREATE INDEX IDX_1C4FAC58575A6A8 ON bac (id_collecte);
CREATE INDEX IDX_1C4FAC58562F6245 ON bac (id_modelebac);
CREATE INDEX IDX_1C4FAC582D8A6AB4 ON bac (id_ptcollecte);
CREATE INDEX IDX_1C4FAC586B3CA4B ON bac (id_user);
CREATE TABLE collecte (id_collecte INT NOT NULL, id_tournee INT DEFAULT NULL, id_user INT DEFAULT NULL, position_collecte INT NOT NULL, PRIMARY KEY(id_collecte));
CREATE INDEX IDX_55AE4A3D356BD40E ON collecte (id_tournee);
CREATE INDEX IDX_55AE4A3D6B3CA4B ON collecte (id_user);
CREATE TABLE constat (id_constat INT NOT NULL, id_bac INT DEFAULT NULL, id_critere INT DEFAULT NULL, id_user INT DEFAULT NULL, date_constat DATE DEFAULT NULL, ref_constat VARCHAR(20) NOT NULL, content_constat VARCHAR(255) DEFAULT NULL, PRIMARY KEY(id_constat));
CREATE INDEX IDX_F96EDD9882EB4402 ON constat (id_bac);
CREATE INDEX IDX_F96EDD98A1F72923 ON constat (id_critere);
CREATE INDEX IDX_F96EDD986B3CA4B ON constat (id_user);
CREATE TABLE critereconstat (id_critere INT NOT NULL, nom_critere VARCHAR(50) NOT NULL, PRIMARY KEY(id_critere));
CREATE TABLE donneecollectee (id_donneecollecte INT NOT NULL, id_tournee INT DEFAULT NULL, id_user INT DEFAULT NULL, date_donneecollecte DATE DEFAULT NULL, distance_donneecollecte INT DEFAULT NULL, temps_donneecollecte TIMESTAMP(0) WITH TIME ZONE DEFAULT NULL, poid_donneecollecte INT DEFAULT NULL, observations_donneecollecte VARCHAR(255) DEFAULT NULL, PRIMARY KEY(id_donneecollecte));
CREATE INDEX IDX_B70D08A1356BD40E ON donneecollectee (id_tournee);
CREATE INDEX IDX_B70D08A16B3CA4B ON donneecollectee (id_user);
CREATE TABLE modelebac (id_modelebac INT NOT NULL, id_format INT DEFAULT NULL, id_ouverture INT DEFAULT NULL, id_typeflux INT DEFAULT NULL, id_user INT DEFAULT NULL, ref_modelebac VARCHAR(10) DEFAULT NULL, nom_modelebac VARCHAR(50) DEFAULT NULL, type_modelebac INT DEFAULT NULL, volume_modelebac INT DEFAULT NULL, PRIMARY KEY(id_modelebac));
CREATE INDEX IDX_D61ADE62F88DC732 ON modelebac (id_format);
CREATE INDEX IDX_D61ADE62C373A28C ON modelebac (id_ouverture);
CREATE INDEX IDX_D61ADE626DF522B4 ON modelebac (id_typeflux);
CREATE INDEX IDX_D61ADE626B3CA4B ON modelebac (id_user);
CREATE TABLE observation (id_observation INT NOT NULL, id_critere INT DEFAULT NULL, id_ptcollecte INT DEFAULT NULL, id_user INT DEFAULT NULL, ref_observation VARCHAR(20) NOT NULL, date_observation DATE DEFAULT NULL, content_observation VARCHAR(255) DEFAULT NULL, PRIMARY KEY(id_observation));
CREATE INDEX IDX_C576DBE0A1F72923 ON observation (id_critere);
CREATE INDEX IDX_C576DBE02D8A6AB4 ON observation (id_ptcollecte);
CREATE INDEX IDX_C576DBE06B3CA4B ON observation (id_user);
CREATE TABLE photo (id_photo INT NOT NULL, id_ptcollecte INT DEFAULT NULL, url_photo VARCHAR(255) DEFAULT NULL, date_photo DATE DEFAULT NULL, PRIMARY KEY(id_photo));
CREATE INDEX IDX_14B784182D8A6AB4 ON photo (id_ptcollecte);
CREATE TABLE point_collecte (id_ptcollecte INT NOT NULL, id_com INT DEFAULT NULL, id_user INT DEFAULT NULL, ref_ptcollecte VARCHAR(20) NOT NULL, nom_ptcollecte VARCHAR(50) DEFAULT NULL, adresse_ptcollecte VARCHAR(100) DEFAULT NULL, lat_ptcollecte NUMERIC(9, 6) NOT NULL, lng_ptcollecte NUMERIC(9, 6) NOT NULL, emplacement_ptcollecte NUMERIC(2, 0) DEFAULT NULL, date_ptcollecte DATE NOT NULL, PRIMARY KEY(id_ptcollecte));
CREATE INDEX IDX_C7CB105FFA122EBC ON point_collecte (id_com);
CREATE INDEX IDX_C7CB105F6B3CA4B ON point_collecte (id_user);
CREATE TABLE population (id_population INT NOT NULL, id_com INT DEFAULT NULL, annee_population INT DEFAULT NULL, nbre_population INT DEFAULT NULL, PRIMARY KEY(id_population));
CREATE INDEX IDX_B449A008FA122EBC ON population (id_com);
CREATE TABLE tournee (id_tournee INT NOT NULL, id_jour INT DEFAULT NULL, id_user INT DEFAULT NULL, ref_tournee VARCHAR(20) NOT NULL, nom_tournee VARCHAR(50) DEFAULT NULL, PRIMARY KEY(id_tournee));
CREATE INDEX IDX_EBF67D7E5137C5C7 ON tournee (id_jour);
CREATE INDEX IDX_EBF67D7E6B3CA4B ON tournee (id_user);
ALTER TABLE bac ADD CONSTRAINT FK_1C4FAC58575A6A8 FOREIGN KEY (id_collecte) REFERENCES collecte (id_collecte) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE bac ADD CONSTRAINT FK_1C4FAC58562F6245 FOREIGN KEY (id_modelebac) REFERENCES modelebac (id_modelebac) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE bac ADD CONSTRAINT FK_1C4FAC582D8A6AB4 FOREIGN KEY (id_ptcollecte) REFERENCES point_collecte (id_ptcollecte) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE bac ADD CONSTRAINT FK_1C4FAC586B3CA4B FOREIGN KEY (id_user) REFERENCES t_users (id_user) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE collecte ADD CONSTRAINT FK_55AE4A3D356BD40E FOREIGN KEY (id_tournee) REFERENCES tournee (id_tournee) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE collecte ADD CONSTRAINT FK_55AE4A3D6B3CA4B FOREIGN KEY (id_user) REFERENCES t_users (id_user) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE constat ADD CONSTRAINT FK_F96EDD9882EB4402 FOREIGN KEY (id_bac) REFERENCES bac (id_bac) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE constat ADD CONSTRAINT FK_F96EDD98A1F72923 FOREIGN KEY (id_critere) REFERENCES critereconstat (id_critere) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE constat ADD CONSTRAINT FK_F96EDD986B3CA4B FOREIGN KEY (id_user) REFERENCES t_users (id_user) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE donneecollectee ADD CONSTRAINT FK_B70D08A1356BD40E FOREIGN KEY (id_tournee) REFERENCES tournee (id_tournee) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE donneecollectee ADD CONSTRAINT FK_B70D08A16B3CA4B FOREIGN KEY (id_user) REFERENCES t_users (id_user) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE modelebac ADD CONSTRAINT FK_D61ADE62F88DC732 FOREIGN KEY (id_format) REFERENCES t_formats (id_format) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE modelebac ADD CONSTRAINT FK_D61ADE62C373A28C FOREIGN KEY (id_ouverture) REFERENCES t_ouvertures (id_ouverture) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE modelebac ADD CONSTRAINT FK_D61ADE626DF522B4 FOREIGN KEY (id_typeflux) REFERENCES t_typeflux (id_typeflux) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE modelebac ADD CONSTRAINT FK_D61ADE626B3CA4B FOREIGN KEY (id_user) REFERENCES t_users (id_user) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE observation ADD CONSTRAINT FK_C576DBE0A1F72923 FOREIGN KEY (id_critere) REFERENCES t_critereobservations (id_critere) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE observation ADD CONSTRAINT FK_C576DBE02D8A6AB4 FOREIGN KEY (id_ptcollecte) REFERENCES point_collecte (id_ptcollecte) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE observation ADD CONSTRAINT FK_C576DBE06B3CA4B FOREIGN KEY (id_user) REFERENCES t_users (id_user) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE photo ADD CONSTRAINT FK_14B784182D8A6AB4 FOREIGN KEY (id_ptcollecte) REFERENCES point_collecte (id_ptcollecte) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE point_collecte ADD CONSTRAINT FK_C7CB105FFA122EBC FOREIGN KEY (id_com) REFERENCES t_communes (id_com) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE point_collecte ADD CONSTRAINT FK_C7CB105F6B3CA4B FOREIGN KEY (id_user) REFERENCES t_users (id_user) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE population ADD CONSTRAINT FK_B449A008FA122EBC FOREIGN KEY (id_com) REFERENCES t_communes (id_com) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE tournee ADD CONSTRAINT FK_EBF67D7E5137C5C7 FOREIGN KEY (id_jour) REFERENCES t_jours (id_jour) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE tournee ADD CONSTRAINT FK_EBF67D7E6B3CA4B FOREIGN KEY (id_user) REFERENCES t_users (id_user) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE t_fondscarte ADD nom_fondcarte VARCHAR(50) NOT NULL;
ALTER TABLE t_fondscarte DROP nom_foncarte;
ALTER TABLE t_fondscarte ALTER id_fondcarte DROP DEFAULT;
ALTER TABLE t_fondscarte ALTER attribution_fondcarte SET NOT NULL;
ALTER TABLE t_fondscarte ALTER attribution_fondcarte TYPE VARCHAR(255);
ALTER TABLE t_fondscarte ALTER minzoom_fondcarte SET NOT NULL;
ALTER TABLE t_fondscarte ALTER maxzoom_fondcarte SET NOT NULL;
ALTER TABLE t_fondscarte ALTER id_typefondcarte DROP NOT NULL;
ALTER TABLE t_fondscarte ADD CONSTRAINT FK_A324C2B4A9B69F7A FOREIGN KEY (id_typefondcarte) REFERENCES t_typesfondscartes (id_typefondcarte) ON DELETE RESTRICT NOT DEFERRABLE INITIALLY IMMEDIATE;
CREATE INDEX IDX_A324C2B4A9B69F7A ON t_fondscarte (id_typefondcarte);
ALTER TABLE t_typesfondscartes ALTER id_typefondcarte DROP DEFAULT;
